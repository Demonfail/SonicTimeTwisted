<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>&lt;undefined&gt;</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>-1023</depth>
  <persistent>0</persistent>
  <parentName>objSceneObject</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>604</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>1</exetype>
        <functionname>action_inherited</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Initialize

// basics
state = 0;
total_bonus = 0;

// name tag
switch objGameData.character_id[0]
{
case 2: name_tag = "TAILS"; break;
case 3: name_tag = "KNUCKLES"; break;
default: name_tag = "SONIC";
}
name_tag += " GOT";



// time bonus
var total_time = objSSLevel.timer div 60;
if total_time &gt; 570 time_bonus = 50000; else
if total_time &gt; 555 time_bonus = 10000; else
if total_time &gt; 540 time_bonus = 5000; else
if total_time &gt; 510 time_bonus = 4000; else
if total_time &gt; 480 time_bonus = 3000; else
if total_time &gt; 420 time_bonus = 2000; else
if total_time &gt; 360 time_bonus = 1000; else
if total_time &gt; 300 time_bonus = 500; else
time_bonus = 0;

// ring bonus
rings_bonus = objSSPlayer.rings*10;

// perfect bonus
if (objSSLevel.total_rings == 0) perfect_bonus = 50000; else
perfect_bonus = -1;

// screen positions
draw_set_font(objResources.fontTitle);
title_ox1 = (objScreen.width * 0.5) - (string_width(name_tag) * 0.5);
title_ox2 = (objScreen.width * 0.5) - 88;
act_ox = (objScreen.width * 0.5) + 88;
score_ox = (objScreen.width * 0.5) - 104; //92;
tally_ox = (objScreen.width * 0.5) + 96;

// offsets
title_offset1 = ceil((title_ox1 + string_width(name_tag)) * 0.0625) * 16;
title_offset2 = ceil((objScreen.width - title_ox2) * 0.0625) * 16;
score_offset1 = ceil((objScreen.width - score_ox) * 0.0625) * 16;
score_offset2 = score_offset1 + 16;
score_offset3 = score_offset1 + 32;
score_offset4 = score_offset1 + 48;

// music
//play_jingle(bgmClear, false);

// start event
alarm[0] = 60;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="3">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
if instance_exists(objSSMessages) &amp;&amp; instance_exists(objSSPlayer)
    if objSSMessages.closing == 2 {
        //stop_all_music(false);
        level_goback();
    } else {
        objSSPlayer.kill = 4;
        visible = false;
       // objSSMessages.alarm[1] = 120;
    }
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="2">
      <action>
        <libid>1</libid>
        <id>611</id>
        <kind>6</kind>
        <userelative>-1</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>state</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>3</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="1">
      <action>
        <libid>1</libid>
        <id>611</id>
        <kind>6</kind>
        <userelative>-1</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>state</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>2</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>301</id>
        <kind>0</kind>
        <userelative>-1</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_set_alarm</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>0</kind>
            <string>176</string>
          </argument>
          <argument>
            <kind>4</kind>
            <string>2</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="0">
      <action>
        <libid>1</libid>
        <id>611</id>
        <kind>6</kind>
        <userelative>-1</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>state</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>1</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>612</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>-1</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_if_variable</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>0</kind>
            <string>title_offset1</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>title_offset2</string>
          </argument>
          <argument>
            <kind>4</kind>
            <string>2</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>301</id>
        <kind>0</kind>
        <userelative>-1</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_set_alarm</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>0</kind>
            <string>(title_offset1/16)+1</string>
          </argument>
          <argument>
            <kind>4</kind>
            <string>1</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>421</id>
        <kind>3</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
      </action>
      <action>
        <libid>1</libid>
        <id>301</id>
        <kind>0</kind>
        <userelative>-1</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_set_alarm</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>0</kind>
            <string>(title_offset2/16)+1</string>
          </argument>
          <argument>
            <kind>4</kind>
            <string>1</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Handle state
switch state
{
case 1: // move offsets (message)
    if title_offset1 title_offset1 -= 16;
    if title_offset2 title_offset2 -= 16;
    break;

case 2: // move offsets (scores)
    if score_offset1 score_offset1 -= 16;
    if score_offset2 score_offset2 -= 16;
    if score_offset3 score_offset3 -= 16;
    if score_offset4 score_offset4 -= 16;
    break;

case 3: // apply scores
    var change;

    // time bonus
    if time_bonus
    {
        change = min(time_bonus, 100);
        time_bonus -= change;
        total_bonus += change;
        player_add_score(change);
    }

    // rings bonus    
    if rings_bonus
    {
        change = min(rings_bonus, 100);
        rings_bonus -= change;
        total_bonus += change;
        player_add_score(change);
    }

    // perfect bonus    
    if perfect_bonus
    {
        change = min(perfect_bonus, 100);
        perfect_bonus -= change;
        total_bonus += change;
        player_add_score(change);
    }

    // if all scores have been added completely
    if not (time_bonus or rings_bonus or perfect_bonus)
    {
        // sound
        audio_stop_sound(sndBeep);
        audio_play_sound(sndChing, 0, false);

        // finished
        state += 1;
        alarm[3] = 220;
    }
    else if ((objScreen.image_index mod 4) == 0)
    {
        // sound
        audio_stop_sound(sndBeep);
        audio_play_sound(sndBeep, 0, false);
    }
    break;
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Draw scorecard
d3d_set_projection_ortho(0, 0, view_wport, view_hport, 0);

draw_set_font(objResources.fontHud);
draw_text_color(score_ox + score_offset1, 112, 'TIME BONUS',c_white,c_white,c_yellow,c_yellow,1);
draw_text_color(score_ox + score_offset2, 128, 'RING BONUS',c_white,c_white,c_yellow,c_yellow,1);
draw_text_color(score_ox + score_offset4, 160, 'TOTAL',c_white,c_white,c_yellow,c_yellow,1);

// text
draw_set_color(c_white);
draw_set_alpha(image_alpha);
draw_set_valign(fa_top);
draw_set_halign(fa_left);
draw_set_font(objResources.fontHud);

draw_set_halign(fa_right);
draw_set_font(objResources.fontHud);
draw_text(tally_ox + score_offset1, 113, time_bonus);
draw_text(tally_ox + score_offset2, 129, rings_bonus);
if perfect_bonus &gt; -1 draw_text(tally_ox + score_offset3, 145, perfect_bonus);
draw_text(tally_ox + score_offset4, 161, total_bonus);


</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
